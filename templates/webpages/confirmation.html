<html>
<head>
	<link rel="stylesheet" type="text/css" href="carepackage.css">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.4/mapbox.css' rel='stylesheet' />
<script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>

</head>

<body>
	<div id="confirmation">
		<div id="receiptholder">
			<h1 id="orderconfirmation">Carepackage confirmation</h1>
			<input type="text" id="locationinput" placeholder="33E West Walnut Street, Philadelphia">
			<div id='map'></div>

			<script>


			L.mapbox.accessToken = 'pk.eyJ1IjoibWFydmlua2VubmlzIiwiYSI6ImdkZklROXMifQ.nS5DKlMcq3QQ-JexjqTQwA';
			var map = L.mapbox.map('map', 'marvinkennis.kpgncinl', {zoomControl: false}, {attributionControl: false})
			    .setView([position.coords.latitude, position.coords.longitude],28);

			var marker = L.marker(new L.LatLng(position.coords.latitude, position.coords.longitude), {
			    icon: L.mapbox.marker.icon({
			        'marker-color': 'ff8888'
			    }),
			    draggable: false
			});
			marker.bindPopup('This marker is draggable! Move it around.');
			marker.addTo(map);

			map.on('move', function () {
			marker.setLatLng(map.getCenter());
		//console.log(map.getCenter());
	});
	//Dragend event of map for update marker position
			map.on('dragend', function(e) {
			        var position = marker.getLatLng();
				lat = Number(position['lat']).toFixed(5);
				lng = Number(position['lng']).toFixed(5);




			var geocoder;
			var map;
			var infowindow = new google.maps.InfoWindow();
			function initialize() {
			  geocoder = new google.maps.Geocoder();
			}

			function codeLatLng() {
			  var lat = parseFloat(latlngStr[0]);
			  var lng = parseFloat(latlngStr[1]);
			  var latlng = new google.maps.LatLng(lat, lng);
			  geocoder.geocode({'latLng': latlng}, function(results, status) {
			    if (status == google.maps.GeocoderStatus.OK) {
			      if (results[1]) {
			        infowindow.setContent(results[1].formatted_address);
			      } else {
			        alert('No results found');
			      }
			    } else {
			      alert('Geocoder failed due to: ' + status);
			    }
			  });
			}

			google.maps.event.addDomListener(window, 'load', initialize);


				// REVERSE GEOCODING GOES HERE 



				http://api.tiles.mapbox.com/v3/marvinkennis.kpgncinl/geocode/39.1223,12.443.json


				//console.log(position);
				setLeafLatLong(lat, lng);
			});
			map.scrollWheelZoom.disable();






			</script>

			<div id="packagedetails">
				<div id="packagedescription">
					Hangover package
					<span class="packageinfo"></br>You saw it coming...</span>
				</div>
				<div id="packageprice">$10</div>
			</div>

			<div id="confirmbutton">Confirm carepackage delivery</div>
		</div>
		<div class="cancelorder">Nah, I'm good</div>
	</div>


</body>
</html>